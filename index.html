<!DOCTYPE html>
<html lang="pl" class="scroll-smooth overflow-x-hidden">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Graeg | Engineering Portfolio</title>
    <meta name="description" content="Portfolio Grzegorza Wojtalczyka - Space Tech & XR Engineer">
    <link rel="icon" type="image/png" href="logo2.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/3.4.0/model-viewer.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { 
                        sans: ['Space Grotesk', 'sans-serif'],
                        mono: ['Space Mono', 'monospace'] 
                    },
                    colors: { scarlet: '#DC143C', void: '#050505', paper: '#f0f0f0' },
                    letterSpacing: { 'spectral': '0.25em', 'tightest': '-0.05em' },
                    backgroundImage: {
                        'grid-pattern': "linear-gradient(to right, rgba(255,255,255,0.05) 1px, transparent 1px), linear-gradient(to bottom, rgba(255,255,255,0.05) 1px, transparent 1px)"
                    }
                }
            }
        }
    </script>

    <style>
        /* --- CORE --- */
        body { background-color: #050505; color: #e5e5e5; cursor: crosshair; transition: background 0.5s; overflow-x: hidden; }
        
        /* Light Mode Overrides */
        body.light-mode { background-color: #e8e8e8; color: #111; }
        body.light-mode .glass-panel { background: rgba(255,255,255,0.85); border-color: rgba(0,0,0,0.1); color: #000; box-shadow: 0 4px 30px rgba(0,0,0,0.05); }
        body.light-mode .text-void { color: #fff !important; } /* Fix dla tekstów na ciemnych tłach w light mode */
        body.light-mode .nav-dot { background-color: #ccc; }
        body.light-mode .nav-dot.active { background-color: #DC143C; }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #DC143C; }

        /* --- UI ELEMENTS --- */
        .glass-panel {
            background: rgba(20, 20, 20, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }
        
        /* Project Hover Preview */
        .project-preview {
            position: fixed;
            pointer-events: none;
            width: 300px;
            height: 200px;
            z-index: 50;
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.8);
            transition: opacity 0.2s, transform 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            border: 1px solid #DC143C;
            background: #000;
            overflow: hidden;
        }
        .project-preview img, .project-preview video { width: 100%; height: 100%; object-fit: cover; }

        /* Magnetic Buttons */
        .magnetic-btn { display: inline-block; transition: transform 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94); }

        /* Glowing Case Study Card */
        .glow-card {
            position: relative;
        }
        .glow-card::before {
            content: '';
            position: absolute;
            inset: -2px;
            background: linear-gradient(45deg, #DC143C, transparent, #8B0000);
            z-index: -1;
            filter: blur(10px);
            opacity: 0.5;
            transition: opacity 0.3s;
        }
        .glow-card:hover::before { opacity: 1; filter: blur(20px); }

        /* Sticky Nav Dots */
        .nav-dot {
            width: 8px; height: 8px; border-radius: 50%; background: #333; transition: all 0.3s; cursor: pointer;
            position: relative;
        }
        .nav-dot::after {
            content: attr(data-label);
            position: absolute; right: 15px; top: 50%; transform: translateY(-50%);
            opacity: 0; transition: opacity 0.3s; font-family: 'Space Mono'; font-size: 10px; white-space: nowrap; color: #DC143C;
            pointer-events: none;
        }
        .nav-dot:hover::after { opacity: 1; }
        .nav-dot.active { background: #DC143C; transform: scale(1.2); }

        /* Utility */
        .text-stroke { -webkit-text-stroke: 1px rgba(255,255,255,0.2); color: transparent; }
        body.light-mode .text-stroke { -webkit-text-stroke: 1px rgba(0,0,0,0.2); }
        .clip-text-image { background-clip: text; -webkit-background-clip: text; color: transparent; background-image: url('https://images.unsplash.com/photo-1550684848-fac1c5b4e853?q=80&w=2070&auto=format&fit=crop'); background-size: cover; background-position: center; }

        /* Mobile Accordion */
        .accordion-content { max-height: 0; overflow: hidden; transition: max-height 0.5s ease-out; }
        .accordion-open { max-height: 500px; }
    </style>
</head>
<body class="selection:bg-scarlet selection:text-white">

    <div class="fixed right-4 top-1/2 -translate-y-1/2 z-50 flex flex-col gap-4 items-end hidden md:flex mix-blend-difference">
        <a href="#hero" class="nav-dot active" data-label="START"></a>
        <a href="#projekty" class="nav-dot" data-label="PROJEKTY"></a>
        <a href="#case-study" class="nav-dot" data-label="FLAGOWIEC"></a>
        <a href="#o-mnie" class="nav-dot" data-label="PROFIL"></a>
        <a href="#stack" class="nav-dot" data-label="ARSENAŁ"></a>
        <a href="#kontakt" class="nav-dot" data-label="KONTAKT"></a>
    </div>

    <div id="cursor-preview" class="project-preview hidden md:block">
        <img id="preview-image" src="" alt="Project Preview">
    </div>

    <nav class="fixed top-0 left-0 w-full z-40 p-6 flex justify-between items-center mix-blend-difference">
        <img src="logo2.png" alt="GRAEG" class="h-8 md:h-10 opacity-80">
        <div class="hidden md:flex gap-8">
            <button id="theme-toggle" class="text-xs font-mono uppercase tracking-widest hover:text-scarlet transition">[ LIGHT / DARK ]</button>
            <span class="text-xs font-mono text-scarlet animate-pulse">SYS: ONLINE</span>
        </div>
    </nav>

    <section id="hero" class="h-screen w-full flex flex-col justify-center items-center relative overflow-hidden">
        <div id="canvas-container" class="absolute inset-0 z-0 opacity-40"></div>
        <div class="z-10 text-center px-4">
            <p class="font-mono text-xs md:text-sm text-scarlet tracking-[0.5em] mb-4 uppercase">System Inżynierii Przyszłości</p>
            <h1 class="text-5xl md:text-9xl font-bold tracking-tighter mb-2 md:mb-6 leading-none">
                GRAEG<span class="text-scarlet">.</span>SYS
            </h1>
            <p class="font-sans text-gray-400 text-sm md:text-xl max-w-xl mx-auto tracking-wide">
                Materializuję kod w fizycznej przestrzeni. <br>
                <span class="text-white font-bold">3D Printing</span> // <span class="text-white font-bold">XR Systems</span> // <span class="text-white font-bold">Space Tech</span>
            </p>
        </div>
        
        <a href="#projekty" class="absolute bottom-10 left-1/2 -translate-x-1/2 text-xs font-mono tracking-widest animate-bounce">
            SCROLL_DOWN
        </a>
    </section>

    <section id="projekty" class="min-h-screen py-24 px-4 md:px-20 relative bg-black/20">
        <div class="max-w-7xl mx-auto">
            <h2 class="text-xs font-mono text-gray-500 mb-12 uppercase tracking-widest border-b border-gray-800 pb-4">
                01. Dziennik Projektowy
            </h2>

            <div class="flex flex-col">
                <div class="project-item border-b border-gray-800 py-8 md:py-12 group relative cursor-pointer" 
                     data-image="https://images.unsplash.com/photo-1614728853913-1e22ba8b8351?q=80&w=2070&auto=format&fit=crop"
                     onclick="toggleAccordion(this)">
                    <div class="flex flex-col md:flex-row md:items-baseline justify-between z-10 relative">
                        <h3 class="text-3xl md:text-7xl font-bold group-hover:text-scarlet transition-colors duration-300 font-sans tracking-tight">
                            Orbital Habitat
                        </h3>
                        <div class="flex gap-4 mt-2 md:mt-0 font-mono text-xs md:text-sm text-gray-500">
                            <span>BLENDER</span>
                            <span>/</span>
                            <span>3D PRINT</span>
                        </div>
                    </div>
                    <div class="accordion-content md:hidden mt-4">
                        <img src="https://images.unsplash.com/photo-1614728853913-1e22ba8b8351?q=80&w=2070&auto=format&fit=crop" class="w-full h-48 object-cover rounded mb-4" alt="Detail">
                        <p class="text-sm text-gray-300 mb-4">Prototyp modułowej stacji orbitalnej wydrukowany w skali 1:100. Analiza ergonomii i systemów podtrzymywania życia.</p>
                        <a href="#" class="text-scarlet text-xs font-bold uppercase tracking-widest">>> Zobacz dokumentację</a>
                    </div>
                </div>

                <div class="project-item border-b border-gray-800 py-8 md:py-12 group relative cursor-pointer" 
                     data-image="https://images.unsplash.com/photo-1592478411213-61535fdd2802?q=80&w=2069&auto=format&fit=crop"
                     onclick="toggleAccordion(this)">
                    <div class="flex flex-col md:flex-row md:items-baseline justify-between z-10 relative">
                        <h3 class="text-3xl md:text-7xl font-bold group-hover:text-scarlet transition-colors duration-300 font-sans tracking-tight">
                            Exo-Glove XR
                        </h3>
                        <div class="flex gap-4 mt-2 md:mt-0 font-mono text-xs md:text-sm text-gray-500">
                            <span>UNITY</span>
                            <span>/</span>
                            <span>ARDUINO</span>
                        </div>
                    </div>
                     <div class="accordion-content md:hidden mt-4">
                        <img src="https://images.unsplash.com/photo-1592478411213-61535fdd2802?q=80&w=2069&auto=format&fit=crop" class="w-full h-48 object-cover rounded mb-4" alt="Detail">
                        <p class="text-sm text-gray-300 mb-4">Rękawica haptyczna zintegrowana z Unity. Pozwala "poczuć" wirtualne obiekty podczas symulacji naprawczych.</p>
                        <a href="#" class="text-scarlet text-xs font-bold uppercase tracking-widest">>> Zobacz demo</a>
                    </div>
                </div>

                <div class="project-item border-b border-gray-800 py-8 md:py-12 group relative cursor-pointer" 
                     data-image="https://images.unsplash.com/photo-1535295972055-1c762f4483e5?q=80&w=1887&auto=format&fit=crop"
                     onclick="toggleAccordion(this)">
                    <div class="flex flex-col md:flex-row md:items-baseline justify-between z-10 relative">
                        <h3 class="text-3xl md:text-7xl font-bold group-hover:text-scarlet transition-colors duration-300 font-sans tracking-tight">
                            Rover AI Nav
                        </h3>
                        <div class="flex gap-4 mt-2 md:mt-0 font-mono text-xs md:text-sm text-gray-500">
                            <span>PYTHON</span>
                            <span>/</span>
                            <span>ROS</span>
                        </div>
                    </div>
                     <div class="accordion-content md:hidden mt-4">
                         <img src="https://images.unsplash.com/photo-1535295972055-1c762f4483e5?q=80&w=1887&auto=format&fit=crop" class="w-full h-48 object-cover rounded mb-4" alt="Detail">
                        <p class="text-sm text-gray-300 mb-4">Algorytm autonomicznego unikania przeszkód dla mini-łazika marsjańskiego. Testowany w środowisku piaszczystym.</p>
                        <a href="#" class="text-scarlet text-xs font-bold uppercase tracking-widest">>> Zobacz kod</a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="case-study" class="py-20 px-4 md:px-20 relative bg-neutral-900/30">
        <div class="max-w-7xl mx-auto">
             <h2 class="text-xs font-mono text-gray-500 mb-8 uppercase tracking-widest">
                02. Flagowy Projekt
            </h2>
            
            <div class="glow-card glass-panel rounded-2xl p-1 md:p-2 overflow-hidden group">
                <div class="relative bg-black rounded-xl overflow-hidden grid md:grid-cols-2">
                    <div class="h-64 md:h-auto relative">
                        <img src="https://images.unsplash.com/photo-1576174464184-fb78fe882bfd?q=80&w=1887&auto=format&fit=crop" class="absolute inset-0 w-full h-full object-cover opacity-80 group-hover:opacity-100 transition duration-700" alt="Helmet">
                        <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent"></div>
                    </div>
                    <div class="p-8 md:p-16 flex flex-col justify-center items-start z-10">
                        <span class="text-scarlet font-bold tracking-widest text-xs mb-4 animate-pulse">● CONCEPT LAB</span>
                        <h3 class="text-4xl md:text-6xl font-bold text-white mb-6 font-sans">AETHER HELMET UI</h3>
                        <p class="text-gray-400 mb-8 leading-relaxed">
                            System HUD nowej generacji dla skafandrów kosmicznych. Wykorzystuje eye-tracking do minimalizacji ruchów dłoni. Zaprojektowany w Figma, prototypowany w Unreal Engine.
                        </p>
                        <button onclick="document.getElementById('cs-modal').classList.remove('hidden')" class="magnetic-btn px-8 py-3 bg-white text-black font-bold uppercase tracking-widest text-xs hover:bg-scarlet hover:text-white transition-colors">
                            Otwórz Case Study
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div id="cs-modal" class="hidden fixed inset-0 z-[100] bg-black/95 backdrop-blur-xl flex justify-center overflow-y-auto">
        <div class="max-w-4xl w-full p-4 md:p-12 relative min-h-screen">
            <button onclick="document.getElementById('cs-modal').classList.add('hidden')" class="fixed top-6 right-6 text-white hover:text-scarlet z-50 p-2 glass-panel rounded-full">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
            </button>
            
            <div class="space-y-16 py-12">
                <div class="text-center">
                    <h2 class="text-5xl md:text-7xl font-bold text-white mb-4">AETHER UI</h2>
                    <p class="text-scarlet font-mono">AUGMENTED REALITY INTERFACE</p>
                </div>

                <div class="grid md:grid-cols-2 gap-12">
                    <div>
                        <h4 class="text-white font-bold uppercase tracking-widest mb-4 border-l-2 border-scarlet pl-4">Problem</h4>
                        <p class="text-gray-400 text-sm leading-relaxed">W tradycyjnych skafandrach astronauci muszą używać manualnych przełączników na przedramieniu, co w rękawicach ciśnieniowych jest trudne i męczące.</p>
                    </div>
                    <div>
                        <h4 class="text-white font-bold uppercase tracking-widest mb-4 border-l-2 border-scarlet pl-4">Rozwiązanie</h4>
                        <p class="text-gray-400 text-sm leading-relaxed">Interfejs rzutowany na szybę hełmu, sterowany śledzeniem wzroku. Skupienie wzroku na ikonie przez 0.5s aktywuje funkcję.</p>
                    </div>
                </div>

                <div class="w-full h-64 md:h-96 bg-gray-900 rounded-lg flex items-center justify-center border border-white/10">
                    <p class="text-gray-500 font-mono">[ WIDEO PROTOTYPU - PLACEHOLDER ]</p>
                </div>

                <div>
                    <h4 class="text-white font-bold uppercase tracking-widest mb-4 border-l-2 border-scarlet pl-4">Proces (Wireframes)</h4>
                    <div class="grid grid-cols-3 gap-4">
                        <div class="bg-gray-800 h-32 rounded border border-white/5"></div>
                        <div class="bg-gray-800 h-32 rounded border border-white/5"></div>
                        <div class="bg-gray-800 h-32 rounded border border-white/5"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <section id="o-mnie" class="py-24 px-4 md:px-20 bg-black">
        <div class="max-w-7xl mx-auto grid md:grid-cols-2 gap-16 items-center">
            <div class="order-2 md:order-1">
                <h2 class="text-xs font-mono text-gray-500 mb-8 uppercase tracking-widest">03. Profil Operatora</h2>
                <h3 class="text-3xl md:text-4xl font-bold text-white mb-6 leading-tight">
                    Inżynieria to dla mnie sztuka <br> <span class="text-scarlet">przetrwania w chaosie.</span>
                </h3>
                <p class="text-gray-400 leading-relaxed mb-8">
                    Łączę surową inżynierię mechaniczną z finezją projektowania cyfrowego. Moim celem nie jest tylko budowanie rzeczy, które działają, ale systemów, które są niezawodne w warunkach krytycznych - czy to w VR, czy na niskiej orbicie okołoziemskiej.
                </p>

                <div class="grid grid-cols-3 gap-6 border-t border-gray-800 pt-8">
                    <div>
                        <span class="block text-3xl font-bold text-white">45+</span>
                        <span class="text-[10px] text-gray-500 font-mono uppercase tracking-wider">Kg Filamentu</span>
                    </div>
                    <div>
                        <span class="block text-3xl font-bold text-white">1.2k</span>
                        <span class="text-[10px] text-gray-500 font-mono uppercase tracking-wider">Commity Github</span>
                    </div>
                    <div>
                        <span class="block text-3xl font-bold text-white">∞</span>
                        <span class="text-[10px] text-gray-500 font-mono uppercase tracking-wider">Kaw Wypitych</span>
                    </div>
                </div>
            </div>
            <div class="order-1 md:order-2 relative">
                <div class="glass-panel p-2 rounded-lg transform rotate-3 hover:rotate-0 transition duration-500">
                    <img src="https://images.unsplash.com/photo-1517420704952-d9f39e95b43e?q=80&w=2070&auto=format&fit=crop" alt="Workshop" class="rounded grayscale hover:grayscale-0 transition duration-500">
                </div>
            </div>
        </div>
    </section>

    <section id="stack" class="py-24 px-4 md:px-20 relative">
        <div class="max-w-7xl mx-auto">
             <h2 class="text-xs font-mono text-gray-500 mb-12 uppercase tracking-widest">04. Tech in Action</h2>
             
             <div class="grid md:grid-cols-3 gap-4">
                 <div class="group relative h-96 overflow-hidden rounded-lg cursor-default border border-white/10">
                     <img src="https://images.unsplash.com/photo-1631553127870-d29813c93245?q=80&w=1965&auto=format&fit=crop" class="absolute inset-0 w-full h-full object-cover opacity-40 group-hover:opacity-60 transition duration-700 scale-100 group-hover:scale-110" alt="Design">
                     <div class="absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent"></div>
                     
                     <div class="absolute bottom-0 left-0 p-8">
                         <h3 class="text-2xl font-bold text-white mb-2">DESIGN & CAD</h3>
                         <ul class="text-xs font-mono text-gray-400 space-y-1">
                             <li>> Fusion 360</li>
                             <li>> Blender 3D</li>
                             <li>> Figma</li>
                         </ul>
                     </div>
                 </div>

                 <div class="group relative h-96 overflow-hidden rounded-lg cursor-default border border-white/10">
                     <img src="https://images.unsplash.com/photo-1555949963-ff9fe0c870eb?q=80&w=2070&auto=format&fit=crop" class="absolute inset-0 w-full h-full object-cover opacity-40 group-hover:opacity-60 transition duration-700 scale-100 group-hover:scale-110" alt="Code">
                     <div class="absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent"></div>
                     
                     <div class="absolute bottom-0 left-0 p-8">
                         <h3 class="text-2xl font-bold text-white mb-2">CODE & LOGIC</h3>
                         <ul class="text-xs font-mono text-gray-400 space-y-1">
                             <li>> Python / C++</li>
                             <li>> Unity (C#)</li>
                             <li>> Web Technologies</li>
                         </ul>
                     </div>
                 </div>

                 <div class="group relative h-96 overflow-hidden rounded-lg cursor-default border border-white/10">
                     <img src="https://images.unsplash.com/photo-1581091226825-a6a2a5aee158?q=80&w=2070&auto=format&fit=crop" class="absolute inset-0 w-full h-full object-cover opacity-40 group-hover:opacity-60 transition duration-700 scale-100 group-hover:scale-110" alt="Build">
                     <div class="absolute inset-0 bg-gradient-to-t from-black via-black/50 to-transparent"></div>
                     
                     <div class="absolute bottom-0 left-0 p-8">
                         <h3 class="text-2xl font-bold text-white mb-2">MANUFACTURING</h3>
                         <ul class="text-xs font-mono text-gray-400 space-y-1">
                             <li>> FDM / SLA Printing</li>
                             <li>> Electronics Soldering</li>
                             <li>> Prototyping</li>
                         </ul>
                     </div>
                 </div>
             </div>
        </div>
    </section>

    <footer id="kontakt" class="py-20 border-t border-white/10 text-center">
        <h2 class="text-4xl md:text-6xl font-bold text-white mb-8">LET'S BUILD <br> <span class="text-stroke">IMPOSSIBLE THINGS</span></h2>
        <div class="flex justify-center gap-6">
            <a href="https://linkedin.com" class="text-scarlet font-mono hover:text-white transition">LINKEDIN</a>
            <a href="https://github.com" class="text-scarlet font-mono hover:text-white transition">GITHUB</a>
            <a href="mailto:kontakt@example.com" class="text-scarlet font-mono hover:text-white transition">EMAIL</a>
        </div>
        <p class="text-gray-600 text-xs mt-12 font-mono">&copy; 2026 GRAEG SYSTEM. ALL RIGHTS RESERVED.</p>
    </footer>

    <script>
        // --- 3D BACKGROUND (THREE.JS) ---
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.getElementById('canvas-container').appendChild(renderer.domElement);

        // Grid/Particles
        const geometry = new THREE.BufferGeometry();
        const count = 1000;
        const positions = new Float32Array(count * 3);
        for(let i=0; i<count*3; i++) { positions[i] = (Math.random() - 0.5) * 10; }
        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
        const material = new THREE.PointsMaterial({ size: 0.02, color: 0xDC143C });
        const particles = new THREE.Points(geometry, material);
        scene.add(particles);

        camera.position.z = 2;

        function animate() {
            requestAnimationFrame(animate);
            particles.rotation.y += 0.001;
            particles.rotation.x += 0.0005;
            renderer.render(scene, camera);
        }
        animate();
        
        window.addEventListener('resize', () => { 
            renderer.setSize(window.innerWidth, window.innerHeight); 
            camera.aspect = window.innerWidth / window.innerHeight; 
            camera.updateProjectionMatrix(); 
        });

        // --- HOVER PREVIEW LOGIC (Desktop) ---
        const preview = document.getElementById('cursor-preview');
        const previewImg = document.getElementById('preview-image');
        const projectItems = document.querySelectorAll('.project-item');

        document.addEventListener('mousemove', (e) => {
            const x = e.clientX;
            const y = e.clientY;
            
            // Move preview
            gsap.to(preview, { x: x, y: y, duration: 0.5, ease: "power2.out" });
        });

        projectItems.forEach(item => {
            item.addEventListener('mouseenter', () => {
                const img = item.getAttribute('data-image');
                previewImg.src = img;
                preview.style.opacity = '1';
                preview.style.transform = 'translate(-50%, -50%) scale(1)';
            });
            item.addEventListener('mouseleave', () => {
                preview.style.opacity = '0';
                preview.style.transform = 'translate(-50%, -50%) scale(0.8)';
            });
        });

        // --- MOBILE ACCORDION LOGIC ---
        function toggleAccordion(element) {
            if(window.innerWidth >= 768) return; // Disable on desktop
            const content = element.querySelector('.accordion-content');
            
            // Close others
            document.querySelectorAll('.accordion-content').forEach(el => {
                if(el !== content) el.style.maxHeight = null;
            });

            if (content.style.maxHeight) {
                content.style.maxHeight = null;
            } else {
                content.style.maxHeight = content.scrollHeight + "px";
            }
        }

        // --- STICKY NAV OBSERVER ---
        const sections = document.querySelectorAll('section');
        const navDots = document.querySelectorAll('.nav-dot');

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    navDots.forEach(dot => {
                        dot.classList.remove('active');
                        if (dot.getAttribute('href') === '#' + entry.target.id) {
                            dot.classList.add('active');
                        }
                    });
                }
            });
        }, { threshold: 0.5 });

        sections.forEach(section => observer.observe(section));

        // --- LIGHT/DARK MODE TOGGLE ---
        const themeBtn = document.getElementById('theme-toggle');
        themeBtn.addEventListener('click', () => {
            document.body.classList.toggle('light-mode');
            if(document.body.classList.contains('light-mode')) {
                material.color.setHex(0x333333); // Dark particles in light mode
                renderer.setClearColor(0xe8e8e8, 0); 
            } else {
                material.color.setHex(0xDC143C); // Scarlet particles in dark mode
            }
        });

    </script>
</body>
</html>
